{"ast":null,"code":"import axios from'axios';// API endpoints\nconst BACKEND_API_URL='http://localhost:8000';const MOCK_API_URL='http://localhost:3001';class ApiService{// Fetch stores from mock API\nasync getStores(){try{// Prefer backend proxy so frontend only talks to our backend\nconst response=await axios.get(\"\".concat(BACKEND_API_URL,\"/api/dashboard/stores\"));const body=response.data;// Normalize possible shapes:\n// - { stores: [...] }\n// - [...] (array)\n// - { data: [...] }\nif(Array.isArray(body))return body;if(Array.isArray(body===null||body===void 0?void 0:body.stores))return body.stores;if(Array.isArray(body===null||body===void 0?void 0:body.data))return body.data;// fallback: try to extract enumerable array-like properties\nreturn[];}catch(error){console.error('Error fetching stores:',error);throw error;}}// Fetch dashboard summary from backend\nasync getDashboardSummary(){const response=await axios.get(\"\".concat(BACKEND_API_URL,\"/api/dashboard/summary\"));return response.data;}// Fetch combined store info (store + orders + metrics)\nasync getDashboardStore(storeId){const response=await axios.get(\"\".concat(BACKEND_API_URL,\"/api/dashboard/store/\").concat(storeId));return response.data;}// Fetch store metrics from backend\nasync getStoreMetrics(storeId){try{// TODO: Implement this to call your backend\nconst response=await axios.get(\"\".concat(BACKEND_API_URL,\"/api/metrics/store/\").concat(storeId));return response.data;}catch(error){console.error('Error fetching metrics:',error);// Return mock data for now\nreturn{store_id:storeId,total_orders_24h:0,total_orders_1h:0,success_rate:0,failure_rate:0,avg_processing_time_minutes:0,total_revenue_24h:0,avg_order_value:0,orders_per_hour:0,error_breakdown:{},timestamp:new Date().toISOString()};}}// Fetch health score from backend\nasync getHealthScore(storeId){try{// TODO: Implement this to call your backend\nconst response=await axios.get(\"\".concat(BACKEND_API_URL,\"/api/health-score/\").concat(storeId));return response.data;}catch(error){console.error('Error fetching health score:',error);// Return mock data for now\nreturn{store_id:storeId,score:75,status:'healthy',factors:{success_rate:85,processing_time:70,revenue_trend:75},timestamp:new Date().toISOString()};}}// Fetch orders from mock API\nasync getOrders(storeId){let limit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;try{const response=await axios.get(\"\".concat(MOCK_API_URL,\"/api/stores/\").concat(storeId,\"/orders\"),{params:{limit}});return response.data.orders;}catch(error){console.error('Error fetching orders:',error);return[];}}// Detect anomalies\nasync detectAnomalies(storeId){try{// TODO: Implement this to call your backend\nconst response=await axios.get(\"\".concat(BACKEND_API_URL,\"/api/anomalies/detect\"),{params:{store_id:storeId}});return response.data;}catch(error){console.error('Error detecting anomalies:',error);return[];}}// Connect to WebSocket for real-time orders\nconnectToOrderStream(onMessage){const ws=new WebSocket('ws://localhost:8000/ws/orders');ws.onmessage=event=>{try{const data=JSON.parse(event.data);if(data.type==='new_order'){onMessage(data.data);}}catch(error){console.error('WebSocket message error:',error);}};ws.onerror=error=>{console.error('WebSocket error:',error);};return ws;}}export const apiService=new ApiService();","map":{"version":3,"names":["axios","BACKEND_API_URL","MOCK_API_URL","ApiService","getStores","response","get","concat","body","data","Array","isArray","stores","error","console","getDashboardSummary","getDashboardStore","storeId","getStoreMetrics","store_id","total_orders_24h","total_orders_1h","success_rate","failure_rate","avg_processing_time_minutes","total_revenue_24h","avg_order_value","orders_per_hour","error_breakdown","timestamp","Date","toISOString","getHealthScore","score","status","factors","processing_time","revenue_trend","getOrders","limit","arguments","length","undefined","params","orders","detectAnomalies","connectToOrderStream","onMessage","ws","WebSocket","onmessage","event","JSON","parse","type","onerror","apiService"],"sources":["C:/Users/Saksham/Loop/frontend/src/services/api.ts"],"sourcesContent":["import axios from 'axios';\nimport { Store, Order, StoreMetrics, HealthScore, Anomaly } from '../types';\n\n// API endpoints\nconst BACKEND_API_URL = 'http://localhost:8000';\nconst MOCK_API_URL = 'http://localhost:3001';\n\nclass ApiService {\n  // Fetch stores from mock API\n  async getStores(): Promise<Store[]> {\n    try {\n      // Prefer backend proxy so frontend only talks to our backend\n      const response = await axios.get(`${BACKEND_API_URL}/api/dashboard/stores`);\n      const body = response.data;\n      // Normalize possible shapes:\n      // - { stores: [...] }\n      // - [...] (array)\n      // - { data: [...] }\n      if (Array.isArray(body)) return body as Store[];\n      if (Array.isArray(body?.stores)) return body.stores as Store[];\n      if (Array.isArray(body?.data)) return body.data as Store[];\n      // fallback: try to extract enumerable array-like properties\n      return [];\n    } catch (error) {\n      console.error('Error fetching stores:', error);\n      throw error;\n    }\n  }\n\n  // Fetch dashboard summary from backend\n  async getDashboardSummary(): Promise<any> {\n    const response = await axios.get(`${BACKEND_API_URL}/api/dashboard/summary`);\n    return response.data;\n  }\n\n  // Fetch combined store info (store + orders + metrics)\n  async getDashboardStore(storeId: string): Promise<any> {\n    const response = await axios.get(`${BACKEND_API_URL}/api/dashboard/store/${storeId}`);\n    return response.data;\n  }\n\n  // Fetch store metrics from backend\n  async getStoreMetrics(storeId: string): Promise<StoreMetrics> {\n    try {\n      // TODO: Implement this to call your backend\n      const response = await axios.get(`${BACKEND_API_URL}/api/metrics/store/${storeId}`);\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching metrics:', error);\n      // Return mock data for now\n      return {\n        store_id: storeId,\n        total_orders_24h: 0,\n        total_orders_1h: 0,\n        success_rate: 0,\n        failure_rate: 0,\n        avg_processing_time_minutes: 0,\n        total_revenue_24h: 0,\n        avg_order_value: 0,\n        orders_per_hour: 0,\n        error_breakdown: {},\n        timestamp: new Date().toISOString()\n      };\n    }\n  }\n\n  // Fetch health score from backend\n  async getHealthScore(storeId: string): Promise<HealthScore> {\n    try {\n      // TODO: Implement this to call your backend\n      const response = await axios.get(`${BACKEND_API_URL}/api/health-score/${storeId}`);\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching health score:', error);\n      // Return mock data for now\n      return {\n        store_id: storeId,\n        score: 75,\n        status: 'healthy',\n        factors: {\n          success_rate: 85,\n          processing_time: 70,\n          revenue_trend: 75\n        },\n        timestamp: new Date().toISOString()\n      };\n    }\n  }\n\n  // Fetch orders from mock API\n  async getOrders(storeId: string, limit: number = 20): Promise<Order[]> {\n    try {\n      const response = await axios.get(`${MOCK_API_URL}/api/stores/${storeId}/orders`, {\n        params: { limit }\n      });\n      return response.data.orders;\n    } catch (error) {\n      console.error('Error fetching orders:', error);\n      return [];\n    }\n  }\n\n  // Detect anomalies\n  async detectAnomalies(storeId?: string): Promise<Anomaly[]> {\n    try {\n      // TODO: Implement this to call your backend\n      const response = await axios.get(`${BACKEND_API_URL}/api/anomalies/detect`, {\n        params: { store_id: storeId }\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error detecting anomalies:', error);\n      return [];\n    }\n  }\n\n  // Connect to WebSocket for real-time orders\n  connectToOrderStream(onMessage: (order: Order) => void): WebSocket {\n    const ws = new WebSocket('ws://localhost:8000/ws/orders');\n    \n    ws.onmessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        if (data.type === 'new_order') {\n          onMessage(data.data);\n        }\n      } catch (error) {\n        console.error('WebSocket message error:', error);\n      }\n    };\n\n    ws.onerror = (error) => {\n      console.error('WebSocket error:', error);\n    };\n\n    return ws;\n  }\n}\n\nexport const apiService = new ApiService();"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAGzB;AACA,KAAM,CAAAC,eAAe,CAAG,uBAAuB,CAC/C,KAAM,CAAAC,YAAY,CAAG,uBAAuB,CAE5C,KAAM,CAAAC,UAAW,CACf;AACA,KAAM,CAAAC,SAASA,CAAA,CAAqB,CAClC,GAAI,CACF;AACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,GAAG,IAAAC,MAAA,CAAIN,eAAe,yBAAuB,CAAC,CAC3E,KAAM,CAAAO,IAAI,CAAGH,QAAQ,CAACI,IAAI,CAC1B;AACA;AACA;AACA;AACA,GAAIC,KAAK,CAACC,OAAO,CAACH,IAAI,CAAC,CAAE,MAAO,CAAAA,IAAI,CACpC,GAAIE,KAAK,CAACC,OAAO,CAACH,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEI,MAAM,CAAC,CAAE,MAAO,CAAAJ,IAAI,CAACI,MAAM,CACnD,GAAIF,KAAK,CAACC,OAAO,CAACH,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEC,IAAI,CAAC,CAAE,MAAO,CAAAD,IAAI,CAACC,IAAI,CAC/C;AACA,MAAO,EAAE,CACX,CAAE,MAAOI,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAC9C,KAAM,CAAAA,KAAK,CACb,CACF,CAEA;AACA,KAAM,CAAAE,mBAAmBA,CAAA,CAAiB,CACxC,KAAM,CAAAV,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,GAAG,IAAAC,MAAA,CAAIN,eAAe,0BAAwB,CAAC,CAC5E,MAAO,CAAAI,QAAQ,CAACI,IAAI,CACtB,CAEA;AACA,KAAM,CAAAO,iBAAiBA,CAACC,OAAe,CAAgB,CACrD,KAAM,CAAAZ,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,GAAG,IAAAC,MAAA,CAAIN,eAAe,0BAAAM,MAAA,CAAwBU,OAAO,CAAE,CAAC,CACrF,MAAO,CAAAZ,QAAQ,CAACI,IAAI,CACtB,CAEA;AACA,KAAM,CAAAS,eAAeA,CAACD,OAAe,CAAyB,CAC5D,GAAI,CACF;AACA,KAAM,CAAAZ,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,GAAG,IAAAC,MAAA,CAAIN,eAAe,wBAAAM,MAAA,CAAsBU,OAAO,CAAE,CAAC,CACnF,MAAO,CAAAZ,QAAQ,CAACI,IAAI,CACtB,CAAE,MAAOI,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C;AACA,MAAO,CACLM,QAAQ,CAAEF,OAAO,CACjBG,gBAAgB,CAAE,CAAC,CACnBC,eAAe,CAAE,CAAC,CAClBC,YAAY,CAAE,CAAC,CACfC,YAAY,CAAE,CAAC,CACfC,2BAA2B,CAAE,CAAC,CAC9BC,iBAAiB,CAAE,CAAC,CACpBC,eAAe,CAAE,CAAC,CAClBC,eAAe,CAAE,CAAC,CAClBC,eAAe,CAAE,CAAC,CAAC,CACnBC,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CACpC,CAAC,CACH,CACF,CAEA;AACA,KAAM,CAAAC,cAAcA,CAACf,OAAe,CAAwB,CAC1D,GAAI,CACF;AACA,KAAM,CAAAZ,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,GAAG,IAAAC,MAAA,CAAIN,eAAe,uBAAAM,MAAA,CAAqBU,OAAO,CAAE,CAAC,CAClF,MAAO,CAAAZ,QAAQ,CAACI,IAAI,CACtB,CAAE,MAAOI,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpD;AACA,MAAO,CACLM,QAAQ,CAAEF,OAAO,CACjBgB,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,SAAS,CACjBC,OAAO,CAAE,CACPb,YAAY,CAAE,EAAE,CAChBc,eAAe,CAAE,EAAE,CACnBC,aAAa,CAAE,EACjB,CAAC,CACDR,SAAS,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CACpC,CAAC,CACH,CACF,CAEA;AACA,KAAM,CAAAO,SAASA,CAACrB,OAAe,CAAwC,IAAtC,CAAAsB,KAAa,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CACjD,GAAI,CACF,KAAM,CAAAnC,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,GAAG,IAAAC,MAAA,CAAIL,YAAY,iBAAAK,MAAA,CAAeU,OAAO,YAAW,CAC/E0B,MAAM,CAAE,CAAEJ,KAAM,CAClB,CAAC,CAAC,CACF,MAAO,CAAAlC,QAAQ,CAACI,IAAI,CAACmC,MAAM,CAC7B,CAAE,MAAO/B,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAC9C,MAAO,EAAE,CACX,CACF,CAEA;AACA,KAAM,CAAAgC,eAAeA,CAAC5B,OAAgB,CAAsB,CAC1D,GAAI,CACF;AACA,KAAM,CAAAZ,QAAQ,CAAG,KAAM,CAAAL,KAAK,CAACM,GAAG,IAAAC,MAAA,CAAIN,eAAe,0BAAyB,CAC1E0C,MAAM,CAAE,CAAExB,QAAQ,CAAEF,OAAQ,CAC9B,CAAC,CAAC,CACF,MAAO,CAAAZ,QAAQ,CAACI,IAAI,CACtB,CAAE,MAAOI,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClD,MAAO,EAAE,CACX,CACF,CAEA;AACAiC,oBAAoBA,CAACC,SAAiC,CAAa,CACjE,KAAM,CAAAC,EAAE,CAAG,GAAI,CAAAC,SAAS,CAAC,+BAA+B,CAAC,CAEzDD,EAAE,CAACE,SAAS,CAAIC,KAAK,EAAK,CACxB,GAAI,CACF,KAAM,CAAA1C,IAAI,CAAG2C,IAAI,CAACC,KAAK,CAACF,KAAK,CAAC1C,IAAI,CAAC,CACnC,GAAIA,IAAI,CAAC6C,IAAI,GAAK,WAAW,CAAE,CAC7BP,SAAS,CAACtC,IAAI,CAACA,IAAI,CAAC,CACtB,CACF,CAAE,MAAOI,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAClD,CACF,CAAC,CAEDmC,EAAE,CAACO,OAAO,CAAI1C,KAAK,EAAK,CACtBC,OAAO,CAACD,KAAK,CAAC,kBAAkB,CAAEA,KAAK,CAAC,CAC1C,CAAC,CAED,MAAO,CAAAmC,EAAE,CACX,CACF,CAEA,MAAO,MAAM,CAAAQ,UAAU,CAAG,GAAI,CAAArD,UAAU,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}